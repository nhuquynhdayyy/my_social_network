<!-- posts/templates/posts/_post_interactive_section.html -->

<!-- Phần Reaction -->
<hr>
<!-- Vùng hiển thị thống kê (số lượng và icon) -->
<div class="d-flex justify-content-between align-items-center mb-2">
    <div id="reaction-stats-{{ post.id }}" class="d-flex align-items-center" style="font-size: 0.9rem;">
        {% with stats=post.get_reaction_stats %}
            {% if stats %}
                <div class="me-2">
                    {% if 'LIKE' in stats %}<span>👍</span>{% endif %}
                    {% if 'LOVE' in stats %}<span>❤️</span>{% endif %}
                    {% if 'HAHA' in stats %}<span>😂</span>{% endif %}
                    {% if 'WOW' in stats %}<span>😮</span>{% endif %}
                    {% if 'SAD' in stats %}<span>😢</span>{% endif %}
                    {% if 'ANGRY' in stats %}<span>😡</span>{% endif %}
                </div>
                <span id="reactions-count-{{ post.id }}">{{ post.reactions.count }}</span>
            {% else %}
                <span id="reactions-count-{{ post.id }}" class="text-muted">Chưa có cảm xúc</span>
            {% endif %}
        {% endwith %}
    </div>
</div>
<!-- Vùng các nút bấm reaction -->
<div class="reaction-buttons-container border-top border-bottom py-1">
    <div class="d-flex justify-content-around">
        <button class="btn btn-light reaction-btn flex-fill" data-post-id="{{ post.id }}" data-reaction-type="LIKE">👍 Thích</button>
        <button class="btn btn-light reaction-btn flex-fill" data-post-id="{{ post.id }}" data-reaction-type="LOVE">❤️ Yêu thích</button>
        <button class="btn btn-light reaction-btn flex-fill" data-post-id="{{ post.id }}" data-reaction-type="HAHA">😂 Haha</button>
        <button class="btn btn-light reaction-btn flex-fill" data-post-id="{{ post.id }}" data-reaction-type="WOW">😮 Wow</button>
        <button class="btn btn-light reaction-btn flex-fill" data-post-id="{{ post.id }}" data-reaction-type="SAD">😢 Buồn</button>
        <button class="btn btn-light reaction-btn flex-fill" data-post-id="{{ post.id }}" data-reaction-type="ANGRY">😡 Phẫn nộ</button>
    </div>
</div>
<!-- Kết thúc phần Reaction -->


<!-- Phần Bình luận -->
<div class="comments-section mt-3" id="comments-section-{{ post.id }}">
    <!-- Danh sách các bình luận đã có -->
    <div class="comment-list">
        {% for comment in post.comments.all %}
            {% include 'posts/_single_comment.html' %}
        {% endfor %}
    </div>
    
    <!-- Form thêm bình luận mới -->
    {% if user.is_authenticated %}
        <form class="comment-form d-flex mt-2" method="POST" action="{% url 'add_comment' post_id=post.id %}">
            {% csrf_token %}
            <input type="text" name="content" class="form-control me-2" placeholder="Viết bình luận..." autocomplete="off">
            <button type="submit" class="btn btn-primary btn-sm">Gửi</button>
        </form>
    {% endif %}
</div>
<!-- Kết thúc phần Bình luận -->