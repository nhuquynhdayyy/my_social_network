<!-- posts/templates/posts/_post_interactive_section.html -->
{% load post_extras %}
<!-- Pháº§n Reaction -->
<hr>
<!-- VÃ¹ng hiá»ƒn thá»‹ thá»‘ng kÃª (sá»‘ lÆ°á»£ng vÃ  icon) -->
<div class="d-flex justify-content-between align-items-center mb-2">
    <div id="reaction-stats-{{ post.id }}" class="d-flex align-items-center" style="font-size: 0.9rem;">
        {% with stats=post.get_reaction_stats %}
            {% if stats %}
                <div class="me-2">
                    {% if 'LIKE' in stats %}<span>ğŸ‘</span>{% endif %}
                    {% if 'LOVE' in stats %}<span>â¤ï¸</span>{% endif %}
                    {% if 'HAHA' in stats %}<span>ğŸ˜‚</span>{% endif %}
                    {% if 'WOW' in stats %}<span>ğŸ˜®</span>{% endif %}
                    {% if 'SAD' in stats %}<span>ğŸ˜¢</span>{% endif %}
                    {% if 'ANGRY' in stats %}<span>ğŸ˜¡</span>{% endif %}
                </div>
                <span id="reactions-count-{{ post.id }}">{{ post.reactions.count }}</span>
            {% else %}
                <span id="reactions-count-{{ post.id }}" class="text-muted">ChÆ°a cÃ³ cáº£m xÃºc</span>
            {% endif %}
        {% endwith %}
    </div>
</div>
{% comment %} <!-- VÃ¹ng cÃ¡c nÃºt báº¥m reaction -->
<div class="reaction-buttons-container border-top border-bottom py-1">
    <div class="d-flex justify-content-around">
        {% with user_reaction=user_reactions_map|get_item:post.id %}
            <button 
                class="btn btn-light reaction-btn flex-fill {% if user_reaction == 'LIKE' %}fw-bold text-primary{% endif %}" 
                data-post-id="{{ post.id }}" data-reaction-type="LIKE">ğŸ‘ ThÃ­ch</button>
            <button 
                class="btn btn-light reaction-btn flex-fill {% if user_reaction == 'LOVE' %}fw-bold text-primary{% endif %}" 
                data-post-id="{{ post.id }}" data-reaction-type="LOVE">â¤ï¸ YÃªu thÃ­ch</button>
            <button 
                class="btn btn-light reaction-btn flex-fill {% if user_reaction == 'HAHA' %}fw-bold text-primary{% endif %}" 
                data-post-id="{{ post.id }}" data-reaction-type="HAHA">ğŸ˜‚ Haha</button>
            <button 
                class="btn btn-light reaction-btn flex-fill {% if user_reaction == 'WOW' %}fw-bold text-primary{% endif %}" 
                data-post-id="{{ post.id }}" data-reaction-type="WOW">ğŸ˜® Wow</button>
            <button 
                class="btn btn-light reaction-btn flex-fill {% if user_reaction == 'SAD' %}fw-bold text-primary{% endif %}" 
                data-post-id="{{ post.id }}" data-reaction-type="SAD">ğŸ˜¢ Buá»“n</button>
            <button 
                class="btn btn-light reaction-btn flex-fill {% if user_reaction == 'ANGRY' %}fw-bold text-primary{% endif %}" 
                data-post-id="{{ post.id }}" data-reaction-type="ANGRY">ğŸ˜¡ Pháº«n ná»™</button>
        {% endwith %}
    </div>
</div>
<!-- Káº¿t thÃºc pháº§n Reaction --> {% endcomment %}
 <!-- posts/templates/posts/_post_interactive_section.html (ÄÃƒ Cáº¬P NHáº¬T) -->

<!-- VÃ¹ng cÃ¡c nÃºt báº¥m tÆ°Æ¡ng tÃ¡c (ThÃ­ch, BÃ¬nh luáº­n, Chia sáº») -->
<div class="d-flex justify-content-around border-top mt-2 pt-1">
    
    <!-- NÃºt ThÃ­ch (Container chÃ­nh cho popup) -->
    <div class="post-reaction-container flex-fill text-center">
        
        <!-- Popup chá»©a cÃ¡c icon reaction (sáº½ hiá»‡n khi hover) -->
        <div class="post-reaction-popup">
            <button class="btn reaction-btn" data-post-id="{{ post.id }}" data-reaction-type="LIKE">ğŸ‘</button>
            <button class="btn reaction-btn" data-post-id="{{ post.id }}" data-reaction-type="LOVE">â¤ï¸</button>
            <button class="btn reaction-btn" data-post-id="{{ post.id }}" data-reaction-type="HAHA">ğŸ˜‚</button>
            <button class="btn reaction-btn" data-post-id="{{ post.id }}" data-reaction-type="WOW">ğŸ˜®</button>
            <button class="btn reaction-btn" data-post-id="{{ post.id }}" data-reaction-type="SAD">ğŸ˜¢</button>
            <button class="btn reaction-btn" data-post-id="{{ post.id }}" data-reaction-type="ANGRY">ğŸ˜¡</button>
        </div>

        <!-- NÃºt "ThÃ­ch" máº·c Ä‘á»‹nh, luÃ´n hiá»ƒn thá»‹ -->
        {% with user_reaction=user_reactions_map|get_item:post.id %}
        <button 
            class="btn btn-light reaction-btn w-100 {% if user_reaction %}fw-bold text-primary{% endif %}" 
            data-post-id="{{ post.id }}" data-reaction-type="LIKE">
            
            {% if user_reaction == 'LIKE' %}ğŸ‘ ThÃ­ch
            {% elif user_reaction == 'LOVE' %}â¤ï¸ YÃªu thÃ­ch
            {% elif user_reaction == 'HAHA' %}ğŸ˜‚ Haha
            {% elif user_reaction == 'WOW' %}ğŸ˜® Wow
            {% elif user_reaction == 'SAD' %}ğŸ˜¢ Buá»“n
            {% elif user_reaction == 'ANGRY' %}ğŸ˜¡ Pháº«n ná»™
            {% else %}ğŸ‘ ThÃ­ch
            {% endif %}
        </button>
        {% endwith %}
    </div>

    <!-- NÃºt BÃ¬nh luáº­n -->
    <div class="flex-fill text-center">
        <a href="{% url 'posts:post_detail' post.id %}" class="btn btn-light w-100">
            ğŸ’¬ BÃ¬nh luáº­n
        </a>
    </div>
    
    <!-- NÃºt Chia sáº» (Giáº£) -->
    <div class="flex-fill text-center">
        <button class="btn btn-light w-100">
            â†ªï¸ Chia sáº»
        </button>
    </div>
</div>


<!-- Pháº§n BÃ¬nh luáº­n -->
<div class="comments-section mt-3" id="comments-section-{{ post.id }}">
    <!-- Danh sÃ¡ch cÃ¡c bÃ¬nh luáº­n Ä‘Ã£ cÃ³ -->
    <div class="comment-list">
        {% for comment in post.comments.all %}
            {% include 'posts/_single_comment.html' %}
        {% endfor %}
    </div>
    
    <!-- Form thÃªm bÃ¬nh luáº­n má»›i -->
    {% if user.is_authenticated %}
        <form class="comment-form d-flex mt-2" method="POST" action="{% url 'posts:add_comment' post_id=post.id %}">
            {% csrf_token %}
            <input type="text" name="content" class="form-control me-2" placeholder="Viáº¿t bÃ¬nh luáº­n..." autocomplete="off">
            <button type="submit" class="btn btn-primary btn-sm">Gá»­i</button>
        </form>
    {% endif %}
</div>
<!-- Káº¿t thÃºc pháº§n BÃ¬nh luáº­n -->